## `r topic_label`

```{r}
data %>%
  filter(str_detect(topic, topic_label)) %>%
  summarise(allocated = sum(allocation, na.rm = TRUE), .by = c("subtopic", "geography")) %>%
  ggplot(aes(x = subtopic, y = allocated, fill = geography)) +
  geom_col() +
  scale_y_continuous(
    labels = scales::label_number(scale = 1 / 1e6, suffix = "M", prefix = "$"),
    limits = c(0, 50 * 1e6)
  ) +
  coord_flip() +
  scale_fill_manual(
    values = racf_palette,
    guide = guide_legend(reverse = TRUE)
  ) +
  scale_x_discrete(limits = rev) +
  labs(x = NULL, y = "Total allocation")
```
